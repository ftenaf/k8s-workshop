<!DOCTYPE html><html lang=en><head><meta http-equiv=Content-Type content="text/html; charset=UTF-8"><meta name=viewport content="width=device-width,initial-scale=1"><link rel="stylesheet" href="slidestyles.css" type="text/css" media="screen" charset="utf-8">

<!-- #ToDo: Change Title for the presentation -->
<title>Presentation Title</title>

</head>
    
<!-- #ToDo: Change 16:9 to 4:3 or vice versa, according to the current projector / screen -->
<body onload="var slideshow = remark.create({ratio: '16:9', navigation: {scroll: true, touch: true, click: false}, countIncrementalSlides: false, highlightLanguage: 'bash', highlightStyle: 'tomorrow-night-blue'});">

<!-- #ToDo: Write your slides in MarkDown here -->
<textarea id="source">

class: center, middle

background-image: url(../images/pixybay-polygon-906202_1280.jpg)
# GitOps  
### Une mise en situation un peu r√©aliste<br>sur Kubernetes avec Flux  

???
Your presenter notes
---
class: blackbg
background-image: url(../images/Montpellier.jpg)

# Synopsis

.blockquote[
T‚Äôen as assez des _talks_ qui d√©ploient des _hello-world_ pour d√©montrer la pertinence de l‚Äôoutil *younameit*.  
√áa tombe bien : ce qui nous int√©resse, c‚Äôest plut√¥t d‚Äôessayer une mise en situation **DevSecOps** un peu r√©aliste.  
On va donc construire pas √† pas un sc√©nario d‚Äôentreprise  avec des _dev teams_, qui _deploy / update / rollback_ des _WebApps_ Pok√©mon sur `Kubernetes`. Elles utilisent `Kustomize` ou des charts `Helm` pour cela.  
C√¥t√© _Ops_, on va aussi se pr√©occuper des enjeux de s√©curit√© de la plateforme : s√©gr√©gations des droits des √©quipes, des flux r√©seau des _WebApps_. Pour cela, nos _Ops_ vont utiliser `Kyverno`. Et puis des applis, √ßa se _monitor_, _patch management_ transparent sur la stack technique, m√©trologie, contr√¥le des activit√©s sur le _cluster_.  
On va voir comment ces √©quipes **collaborent** entre elles au quotidien dans un _workflow_ **GitOps** qui s‚Äôappuie sur `Kubernetes` et `Flux`, autour d'un code stock√© dans Github,  et plein d‚Äôautres choses encore‚Ä¶
]
---
class: center, middle, blackbg
background-image: url(../images/Montpellier.jpg)
name: Speakers

.left-column[
### Laurent Grangeau
#### Solution architect @ Google
[@laurentgrangeau](https://twitter.com/laurentgrangeau/) on Twitter
![Laurent Grangeau](../images/laurentgrangeau.jpg)
]
.right-column[
### Ludovic Piot
#### DevOps & Cloud architect Freelance
[@lpiot](https://twitter.com/lpiot/) on Twitter
![Ludovic Piot](../images/lpiot.jpg)
]
---
class: center, middle, blackbg
background-image: url(../images/Montpellier.jpg)
name: Pour suivre‚Ä¶

## Pour suivre‚Ä¶

1. les d√©p√¥ts sont dans `Github` : https://github.com/one-kubernetes
1. le d√©p√¥t principal : https://github.com/one-kubernetes/workshop
1. le pr√©sent [_slidedeck_](https://github.com/one-kubernetes/workshop/blob/main/slidedecks/slidedeck-fr.html) en üá´üá∑
1. les [instructions du _workshop_](https://github.com/one-kubernetes/workshop/blob/main/documentation/flux-multi-tenant.md)
---
class: center, middle, blackbg
background-image: url(../images/pixybay-polygon-906202_1280.jpg)

# Le sc√©nario‚Ä¶
---
class: center, middle, blackbg
background-image: url(../images/Montpellier.jpg)

## 2 √©quipes de dev

* 2 √©quipes *dev1* et *dev2* con√ßoivent chacune une application _Pokemon_.
* un _Pokemon_ par application.

.left-column[
#### dev1
![dev1_website001](../images/dev1_website001.png)
]
.right-column[
#### dev2
![dev2_website001](../images/dev2_website001.png)
]
---
class: middle, blackbg
background-image: url(../images/Montpellier.jpg)

## L'application Pokemon ID

L'application est un site Web statique affichant la fiche _PokeDex_ d'un _Pokemon_.
Chaque √©quipe dispose de son ou ses d√©p√¥ts `Github` (un par app).

.left-column[
	https://github.com/one-kubernetes/dev1-aspicot-app
	![dev1_files](../images/dev1_files.png)  
]
.right-column[
	https://github.com/one-kubernetes/dev2-carapuce-app
	![dev2_files](../images/dev2_files.png)  
]
---
class: blackbg
background-image: url(../images/Montpellier.jpg)

### Le code de l'application Pokemon ID

Une simple page `html` affichant la page _PokeDex_ d'un _Pokemon_‚Ä¶  

#### app/index.html
```html
<!doctype html>
<html lang=en>
(‚Ä¶)
<body>
(‚Ä¶)
	<img src="https://assets.pokemon.com/assets/cms2/img/pokedex/full/013.png">
(‚Ä¶)
	<div class="message">
		<h1>Aspicot #013</h1>
		<div class="congrats">L'aiguillon sur son front est tr√®s pointu.(‚Ä¶)</div>
	</div>
(‚Ä¶)
</html>
```
‚Ä¶ incluse dans une image Docker incluant un Web server `NGinx`.

#### Dockerfile

```dockerfile
FROM nginx:1.21.3-alpine
ADD app/index.html /usr/share/nginx/html
```
---	
class: middle, blackbg
background-image: url(../images/Montpellier.jpg)

### Des √©volutions dans l'application Pokemon ID

L'√©quipe dev2 va vouloir faire des mises √† jour sur son application.

.left-column[
	![dev2_files](../images/dev2_website002.png)  
]
.right-column[
	![dev2_files](../images/dev2_website003.png)  
]
---
class: middle, blackbg
background-image: url(../images/Montpellier.jpg)

### Comment d√©ployer¬†?

* La cible de d√©ploiement est un _namespace_ d√©di√© sur le cluster `Kubernetes` de production de l'entreprise.
* L'√©quipe **dev1** produit donc le fichier `YAML` qui va construire les ressources `Kubernetes` n√©cessaires au d√©ploiement de son application.
.left-column[
deployment.yaml
```YAML
apiVersion: apps/v1
kind: Deployment
metadata:
  name: dev1-aspicot
  namespace: dev1-ns
  labels:
    app: dev1-aspicot
spec:
  replicas: 1
  selector:
    matchLabels:
      app: dev1-aspicot
  template:
    metadata:
      labels:
        app: dev1-aspicot

```
]
.right-column[
```yaml
    spec:
      containers:
      - name: dev1-aspicot
        image: thegaragebandofit/dev1-aspicot:1.0
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: dev1-aspicot-service
  namespace: dev1-ns
spec:
  selector:
    app: dev1-aspicot
  ports:
  - name: http
    protocol: TCP
    port: 80
    targetPort: 80
  type: LoadBalancer

```
]
---
* L'√©quipe *ops* dispose d'un _cluster_ `Kubernetes` sur lequel les applications _Pokemon_ vont pouvoir √™tre d√©ploy√©es.
* Elle met √† disposition un _namespace_ d√©di√© et **isol√©** pour chacune des √©quipes **dev1** et **dev2**.
* Pour cela, 
---

###

Both devs build very simple Web apps that display Pokemon ID card. One Pokemon per app.
Once the Web apps are developped, built and packaged, devs want to deploy them onto a Kubernetes cluster.
The thing is‚Ä¶ how to smartly deploy without relying on ops?

A first historical version of the workshop is performed on Ms Azure and every command is performed from a Docker container that is our work environment so nothing is required but:

a browser
and a Google Cloud account able to provision resources on GKE.
or an Azure account able to provision resources on Azure (especially AKS).
First, we detail how to set-up this working environment within a Docker image. How to build it and run it interactively.

Second, we provision a Kubernetes cluster in AKS.
Then, we have a scenario on 3 tracks:



---
name: ForSlideInterLinking

background-color: purple

# HowTo: Presenting

1. Open the HTML file in a browser (via 'file://' or local webserver)
2. Press 'c' to clone the current view into a new, synced window
3. Press 'p' in the original window to enter Presenter Console
4. Move the cloned window to projector / screen display
5. Press 'f' to make the cloned window fullscreen
6. Enjoy!

Hint: You can always press 'h' to see an overview of all available key commands.

---

# HowTo: PDF Export

1. Install DeckTape: https://github.com/astefanutti/decktape
2. Start a local webserver inside slide deck directory (e.g. 'python -m http.server')
2. Go to local DeckTape repository using your terminal
3. Run: './bin/phantomjs decktape.js http://127.0.0.1:8080/slidedeck.html slidedeck.pdf
4. Be proud of your beautiful slidedeck.pdf file!

P.S.: Provide fallback images for videos as shown in video slide example code.

---

# Numbered List

1. Lorem Ipsum
2. Dolor Sit Amet
3. Sic transit
4. Gloria Mundi

???
Your presenter notes

---

# Bulletpoint List

* Lorem Ipsum
* Dolor Sit Amet
* Sic transit
* Gloria Mundi

???
Your presenter notes

---

class: center, middle, blackbg

background-image: url(media/flexboxbg.jpg)

#### And Now

--

### For Some

--

# Incrementation

--

## On The Same Slide

---

background-image: url(media/pixybay-polygon-906202_1280.jpg)

class: top, center

# BLOCKQUOTE

.blockquote[Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris quis mi tellus. Sed massa massa, luctus id efficitur et, fringilla vel velit. Nullam efficitur ante et sapien fermentum semper. Morbi vehicula sapien enim, vitae sagittis elit pharetra semper. Etiam pharetra maximus orci sed scelerisque mauris. Etiam pharetra maximus orci sed scelerisquest.

Author Name, 2001]

???
Your presenter notes

---

class: top, center

![Dummy Picture](media/buffy-stake-tool-capable.gif)
.footnote[Photo Credits]

???
Your presenter notes

---

class: center, middle, redbg

background-image: url(media/pixybay-polygon-906202_1280.jpg)
# Background Tinting
## blackbg, redbg & bluebg

???
Your presenter notes

---


class: top, center

# Two Columns

.left-column[
![Dummy Picture](media/flexboxbg.jpg)]

.right-column[
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris quis mi tellus. Sed massa massa, luctus id efficitur et, fringilla vel velit. Nullam efficitur ante et sapien fermentum semper. Morbi vehicula sapien enim, vitae sagittis elit pharetra semper. Etiam pharetra maximus orci, sed scelerisque mauris lacinia quis. Aliquam erat volutpat.]

???
Your presenter notes

---

.video[
<iframe src="http://www.youtube.com/embed/9VlHOlrYcO8" frameborder="0" allowfullscreen></iframe>]

.video[
![Video Image Screenshot for PDF Export](media/flexboxbg.jpg)]

.footnote[YouTube Video Credits]

---

.video[
<video controls>
  <source src="media/localvideo.webm" type="video/webm">
  <source src="media/localvideo.mp4" type="video/mp4">
</video>]

.video[
![Video Image Screenshot for PDF Export](media/flexboxbg.jpg)]

.footnote[Local HTML5 Video Credits]

---
class: center, middle

# Cr√©dits
* slides app created by [Tobias Baldauf](http://who.tobias.is/), [@tbaldauf](https://twitter.com/tbaldauf) based on [Remark.js](https://github.com/gnab/remark/)
* Photo de Montpellier : ../images/Montpellier.jpg


</textarea><script type="text/javascript" src="remark-latest.min.js"></script></body></html>